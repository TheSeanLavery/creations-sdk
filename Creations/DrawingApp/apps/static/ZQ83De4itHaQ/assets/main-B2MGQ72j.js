(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function i(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=i(s);fetch(s.href,r)}})();class k{constructor(){this.sideButtonEnabled=!0,this.scrollWheelEnabled=!0,this.eventListeners=new Map}init(e={}){this.sideButtonEnabled=e.sideButtonEnabled??!0,this.scrollWheelEnabled=e.scrollWheelEnabled??!0,this.sideButtonEnabled&&this.setupSideButtonListener(),this.scrollWheelEnabled&&this.setupScrollWheelListener(),e.keyboardFallback!==!1&&this.setupKeyboardFallback()}setupSideButtonListener(){window.addEventListener("sideClick",e=>{this.sideButtonEnabled&&this.handleSideButtonClick(e)})}setupScrollWheelListener(){window.addEventListener("scrollUp",e=>{this.scrollWheelEnabled&&this.handleScrollWheel({direction:"up",event:e})}),window.addEventListener("scrollDown",e=>{this.scrollWheelEnabled&&this.handleScrollWheel({direction:"down",event:e})})}setupKeyboardFallback(){window.addEventListener("keydown",e=>{if(e.code==="Space"){e.preventDefault();const i=new CustomEvent("sideClick",{detail:{source:"keyboard"}});window.dispatchEvent(i)}})}handleSideButtonClick(e){(this.eventListeners.get("sideButton")||[]).forEach(o=>o(e))}handleScrollWheel(e){(this.eventListeners.get("scrollWheel")||[]).forEach(o=>o({direction:e.direction,event:e.event}))}on(e,i){this.eventListeners.has(e)||this.eventListeners.set(e,[]),this.eventListeners.get(e).push(i)}off(e,i){const o=this.eventListeners.get(e)||[],s=o.indexOf(i);s>-1&&o.splice(s,1)}}const C=new k;class W{constructor(){this.screenWidth=240}setupViewport(){let e=document.querySelector('meta[name="viewport"]');e||(e=document.createElement("meta"),e.name="viewport",document.head.appendChild(e)),e.content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"}}const S=new W;S.setupViewport();C.init();const n=document.getElementById("pad"),h=document.createElement("canvas"),c=h.getContext("2d");n==null||n.appendChild(h);const d=document.createElement("div");d.id="hud";d.textContent="";n==null||n.appendChild(d);function x(){const t=window.devicePixelRatio||1,e=(n==null?void 0:n.clientWidth)||window.innerWidth,i=(n==null?void 0:n.clientHeight)||window.innerHeight;h.style.width=e+"px",h.style.height=i+"px",h.width=Math.floor(e*t),h.height=Math.floor(i*t),c.setTransform(t,0,0,t,0,0),c.lineCap="round",c.lineJoin="round",c.strokeStyle="#FE5F00",c.lineWidth=4}window.addEventListener("resize",x);x();let v=!1,g=0,y=0;function u(t,e){const i=h.getBoundingClientRect();return{x:t-i.left,y:e-i.top}}function L(t,e,i){return Math.min(i,Math.max(e,t))}function f(t,e){return Math.max(t||0,e||0)}function b(t){const e=L(t,.5,10),i=Math.log(50)/Math.log(20),s=Math.pow(2,i)*Math.pow(e,i);return L(s,1,50)}function p(t){d&&(t&&t>0?(d.textContent=t.toFixed(1),d.style.display="block"):(d.textContent="",d.style.display="none"))}function E(t,e,i=4,o=4){v=!0,g=t,y=e;const s=f(i,o);c.lineWidth=b(s)}function a(t,e){v&&(c.beginPath(),c.moveTo(g,y),c.lineTo(t,e),c.stroke(),g=t,y=e)}function w(){v=!1,p(0)}function m(t,e=""){const i=[];if(t.width&&t.height&&i.push({type:t.pointerType||"touch",width:t.width,height:t.height,pressure:t.pressure??0}),t.touches&&t.touches.length)for(const o of t.touches){const s=o.radiusX??o.webkitRadiusX,r=o.radiusY??o.webkitRadiusY;s&&r&&i.push({type:"touch",width:s*2,height:r*2,force:o.force??o.webkitForce??void 0})}if(i.length){const o=i[0],s=window.devicePixelRatio||1;console.log(`[${e}] size ≈ ${o.width.toFixed(1)}×${o.height.toFixed(1)} CSS px (${(o.width*s).toFixed(1)}×${(o.height*s).toFixed(1)} device px)`,o)}}n==null||n.addEventListener("pointerdown",t=>{var e;if(t.pointerType==="touch"){const{x:i,y:o}=u(t.clientX,t.clientY);E(i,o,t.width??4,t.height??4);const s=f(t.width,t.height);p(s),a(i,o),(e=n.setPointerCapture)==null||e.call(n,t.pointerId),m(t,"pointerdown")}else if(t.pointerType==="mouse"){const{x:i,y:o}=u(t.clientX,t.clientY);E(i,o),a(i,o)}});n==null||n.addEventListener("pointermove",t=>{if(!v)return;const{x:e,y:i}=u(t.clientX,t.clientY);if(t.pointerType==="touch"){const o=f(t.width,t.height);c.lineWidth=b(o),p(o),m(t,"pointermove")}a(e,i)});n==null||n.addEventListener("pointerup",()=>w());n==null||n.addEventListener("pointercancel",()=>w());n==null||n.addEventListener("pointerleave",()=>w());n==null||n.addEventListener("touchstart",t=>{const e=t.touches[0];if(!e)return;const{x:i,y:o}=u(e.clientX,e.clientY),s=e.radiusX??e.webkitRadiusX??2,r=e.radiusY??e.webkitRadiusY??2,l=f(s*2,r*2);E(i,o,s*2,r*2),p(l),a(i,o),m(t,"touchstart")},{passive:!0});n==null||n.addEventListener("touchmove",t=>{const e=t.touches[0];if(!e)return;const{x:i,y:o}=u(e.clientX,e.clientY),s=e.radiusX??e.webkitRadiusX??2,r=e.radiusY??e.webkitRadiusY??2,l=f(s*2,r*2);c.lineWidth=b(l),p(l),a(i,o),m(t,"touchmove")},{passive:!0});n==null||n.addEventListener("touchend",()=>w(),{passive:!0});n==null||n.addEventListener("touchcancel",()=>w(),{passive:!0});console.log("Drawing App Ready!");
