(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))d(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const E of o.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&d(E)}).observe(document,{childList:!0,subtree:!0});function a(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function d(n){if(n.ep)return;n.ep=!0;const o=a(n);fetch(n.href,o)}})();console.log(typeof PluginMessageHandler<"u"?"Running as R1 Creation":"Running in browser mode");let t={isPlaying:!1,isPaused:!1,score:0,highestY:0,screenScrollY:0,platformSpeed:1,gameStarted:!1,musicMuted:!1,sfxMuted:!1},e={x:120,y:200,radius:8,velocityX:0,velocityY:0,onGround:!0,color:"#FE5F00"},c=[],f,r,g=null,l=null,h=!1;const O=.1,m=.8,M=6,Y=.85,T=.98,v=60,p=8,S=260,u=240,P=254,w=100,C=-.1;function I(i){return{x:Math.random()*(u-v),y:i,width:v,height:p,color:"#fff"}}function X(){c=[],c.push({x:0,y:S,width:u,height:p,color:"#fff",isGround:!0});const i=S-60;g={x:Math.floor((u-v)/2),y:i,width:v,height:p,color:"#fff",isStart:!0},c.push(g);for(let s=1;s<=20;s++)c.push(I(i-s*80))}function _(){if(!t.isPlaying||t.isPaused)return;if(e.velocityY+=O,e.x+=e.velocityX,e.y+=e.velocityY,e.x-e.radius<0?(e.x=e.radius,e.velocityX=0):e.x+e.radius>u&&(e.x=u-e.radius,e.velocityX=0),e.velocityX*=e.onGround?Y:T,Math.abs(e.velocityX)<.01&&(e.velocityX=0),e.y<S-50&&!t.gameStarted&&(t.gameStarted=!0),t.gameStarted){const s=e.y-t.screenScrollY;if(s<w){const a=w-s;t.screenScrollY+=a*C}}const i=Math.max(0,S-e.y);for(i>t.highestY&&(t.highestY=i,t.score=Math.floor(t.highestY/10)),t.platformSpeed=.2+t.score*.01,c.forEach(s=>{s.y+=t.platformSpeed}),c=c.filter(s=>s.y<t.screenScrollY+P+100);c.length<25;){const s=Math.min(...c.map(a=>a.y));c.push(I(s-80))}e.y>t.screenScrollY+P+50&&A()}function B(){!t.isPlaying||t.isPaused||(e.onGround=!1,c.forEach(i=>{e.x+e.radius>i.x&&e.x-e.radius<i.x+i.width&&e.y+e.radius>i.y&&e.y-e.radius<i.y+i.height&&e.velocityY>0&&e.y<i.y&&(e.y=i.y-e.radius,e.velocityY=-6.5,e.onGround=!0,i.color="#FE5F00",setTimeout(()=>{i.color="#fff"},100))}))}function k(){r.fillStyle="#000",r.fillRect(0,0,u,P),r.save(),r.translate(0,-t.screenScrollY),c.forEach(i=>{r.fillStyle=i.color,r.fillRect(i.x,i.y,i.width,i.height)}),r.fillStyle=e.color,r.beginPath(),r.arc(e.x,e.y,e.radius,0,Math.PI*2),r.fill(),r.restore(),document.getElementById("score").textContent=`Score: ${t.score}`}function b(){_(),B(),k(),t.isPlaying&&requestAnimationFrame(b)}function L(){t.isPlaying=!0,t.score=0,t.highestY=0,t.screenScrollY=0,t.platformSpeed=1,t.gameStarted=!1,X(),e.velocityX=0,e.velocityY=0,e.onGround=!0,g?(e.x=g.x+g.width/2,e.y=g.y-e.radius):(e.x=120,e.y=200),document.getElementById("gameOver").classList.add("hidden"),b()}function A(){t.isPlaying=!1,document.getElementById("finalScore").textContent=t.score,document.getElementById("gameOver").classList.remove("hidden"),f.style.filter="brightness(1.5)",setTimeout(()=>{f.style.filter="brightness(1)"},200)}window.addEventListener("scrollUp",()=>{t.isPlaying&&(e.velocityX=Math.max(e.velocityX-m,-M))});window.addEventListener("scrollDown",()=>{t.isPlaying&&(e.velocityX=Math.min(e.velocityX+m,M))});window.addEventListener("sideClick",()=>{t.isPlaying||L(),y()});document.addEventListener("keydown",i=>{if(typeof PluginMessageHandler>"u")switch(i.key){case" ":i.preventDefault(),t.isPlaying||L(),y();break;case"ArrowLeft":t.isPlaying&&(e.velocityX=Math.max(e.velocityX-m,-M));break;case"ArrowRight":t.isPlaying&&(e.velocityX=Math.min(e.velocityX+m,M));break}});document.addEventListener("DOMContentLoaded",()=>{console.log("Bouncing Ball Game initialized!"),f=document.getElementById("gameCanvas"),r=f.getContext("2d"),f.width=u,f.height=P;const i=document.getElementById("settingsButton"),s=document.getElementById("settingsMenu"),a=document.getElementById("musicMuteToggle"),d=document.getElementById("sfxMuteToggle");i&&s&&(i.addEventListener("click",n=>{n.stopPropagation(),s.classList.toggle("hidden"),!s.classList.contains("hidden")?t.isPlaying&&(t.isPaused=!0):t.isPaused&&(t.isPaused=!1)}),document.addEventListener("click",n=>{s.classList.contains("hidden")||!s.contains(n.target)&&n.target!==i&&(s.classList.add("hidden"),t.isPaused&&(t.isPaused=!1))}));try{const n=localStorage.getItem("bbg_musicMuted"),o=localStorage.getItem("bbg_sfxMuted");n!==null&&(t.musicMuted=n==="true"),o!==null&&(t.sfxMuted=o==="true")}catch{}a&&(a.checked=t.musicMuted,a.addEventListener("change",()=>{t.musicMuted=a.checked,x(),G()})),d&&(d.checked=t.sfxMuted,d.addEventListener("change",()=>{t.sfxMuted=d.checked,x()})),R(),typeof PluginMessageHandler>"u"&&(window.addEventListener("keydown",n=>{n.code==="Space"&&(n.preventDefault(),window.dispatchEvent(new CustomEvent("sideClick")))}),["pointerdown","touchstart","click"].forEach(n=>{window.addEventListener(n,y,{once:!0})})),L(),y()});console.log("Bouncing Ball Game Ready!");console.log("Controls:");console.log("- Scroll wheel: Move ball left/right");console.log("- Side button: Restart game");function R(){if(!l)try{const i=new URL(""+new URL("banger1-D-KldX_V.mp3",import.meta.url).href,import.meta.url).href;l=new Audio(i),l.loop=!0,l.volume=.4,l.muted=!!t.musicMuted}catch(i){console.warn("Failed to initialize background music",i)}}function y(){if(l||R(),!l||h||(h=!0,t.musicMuted))return;const i=l.play();i&&typeof i.then=="function"&&i.catch(()=>{h=!1})}function G(){l&&(l.muted=!!t.musicMuted,t.musicMuted?l.pause():(h=!1,y()))}function x(){try{localStorage.setItem("bbg_musicMuted",String(!!t.musicMuted)),localStorage.setItem("bbg_sfxMuted",String(!!t.sfxMuted))}catch{}}
